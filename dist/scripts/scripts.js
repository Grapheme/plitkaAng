"use strict";angular.module("plitkaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$httpProvider",function(a){a.defaults.cache=!0}]).run(["$http",function(a){a.get("http://plitka.dev.grapheme.ru/application/get").success(function(){$(".loader").fadeOut(400)})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"MCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/contacts",{templateUrl:"views/contacts.html",controller:"ContactsCtrl",controllerAs:"ContCtrl"}).when("/articles",{templateUrl:"views/articles.html",controller:"ArticlesCtrl",controllerAs:"ArtCtrl"}).when("/catalog",{templateUrl:"views/catalog.html",controller:"CatalogCtrl",controllerAs:"CatCtrl"}).when("/catalog/:id",{templateUrl:"views/catalog.html",controller:"CatalogCtrl",controllerAs:"CatCtrl"}).when("/projects",{templateUrl:"views/projects.html",controller:"ProjectsCtrl",controllerAs:"ProjCtrl"}).when("/article/:id",{templateUrl:"views/separticle.html",controller:"SeparticleCtrl",controllerAs:"SepCtrl"}).when("/404",{templateUrl:"views/404.html"}).when("/search-results",{templateUrl:"views/search-results.html",controller:"SearchResultsCtrl"}).when("/catalog-item/:id",{templateUrl:"views/catalog-item.html",controller:"CatalogItemCtrl",controllerAs:"CatItemCtrl"}).when("/collection/:id",{templateUrl:"views/collection.html",controller:"CollectionCtrl",controllerAs:"CollCtrl"}).otherwise({redirectTo:"/404"})}]),angular.module("plitkaApp").controller("MainCtrl",["$http","$rootScope",function(a){var b=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){b.data=a,b.articles=b.data.articles,b.photos=b.data.photos,b.articlesArr=$.map(b.articles,function(a){return[a]}),b.promo=b.data.promo,console.log(b.promo),setTimeout(function(){jQuery(".fotorama").fotorama({width:"100%",height:"400",nav:!1,arrows:"always",autoplay:3e3,loop:!0})},100)})}]),angular.module("plitkaApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],jQuery(".fotorama").fotorama({width:"100%",height:"400",nav:!1,arrows:"always"})}]),angular.module("plitkaApp").controller("ContactsCtrl",["$http",function(){this.mapTo="salon",this.mapCoords={salon:{x:47.244747,y:39.723161},store:{x:47.256845,y:39.624738}},this.setMap=function(a){this.mapTo=a,this.initialize(this.mapCoords[this.mapTo])},this.checkMap=function(a){return this.mapTo===a},this.initialize=function(a){{var b={zoom:15,zoomControl:!1,draggable:!1,scrollwheel:!1,center:new google.maps.LatLng(a.x,a.y),mapTypeId:google.maps.MapTypeId.ROADMAP},c=new google.maps.Map(document.getElementById("map_canvas"),b);new google.maps.Marker({position:b.center,map:c})}},this.setMap("salon"),this.formData={},this.sendForm=function(a){$.ajax({type:"POST",url:"http://plitka.dev.grapheme.ru/ajax/feedback",data:{name:a.name,email:a.email,text:a.text},dataType:"json"}).done(function(){}).fail(function(){}).always(function(){})}}]),angular.module("plitkaApp").controller("ArticlesCtrl",["$http","$rootScope",function(a){var b=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){b.data=a,b.articles=b.data.articles,b.photos=b.data.photos})}]),angular.module("plitkaApp").controller("CatalogCtrl",["$http",function(a){var b=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){b.data=a,b.productType=b.data.product_type,b.collections=b.data.collections,b.products=b.data.products,b.countries=b.data.countries,b.factories=b.data.factory,b.photos=b.data.photos,b.galleries=b.data.galleries,b.colors=b.data.colors,b.collectionColors=b.data.collections_colors,b.collectionPrices=b.data.collections_prices,b.surfaceTypes=b.data.surface_type,b.collectionSurfaces=b.data.collections_surface_types,b.places=b.data.scope,b.collectionPlaces=b.data.collections_scopes,b.chosenProduct=b.productType[Object.keys(b.productType)[0]],b.chosenProductId=b.chosenProduct.id,b.collectionsArr=[];for(var c in b.collections)b.collections[c].product_type_id===b.chosenProductId&&b.collectionsArr.push(b.collections[c]);b.collections=$.map(b.collections,function(a){return[a]}),b.countryFilter=[],b.factoryFilter=[],b.colorFilter=[],b.colorFilterArr=[],b.minPrice="",b.surfaceFilter=[],b.surfaceFilterArr=[],b.placeFilter=[],b.placeFilterArr=[],b.setCountryFilter=function(a){var c=$(".filter-countries");-1==b.countryFilter.indexOf(a)?(b.countryFilter.push(a),c.find('[data-country="'+a+'"]').addClass("active")):(b.countryFilter.splice(b.countryFilter.indexOf(a),1),console.log(a),c.find('[data-country="'+a+'"]').removeClass("active")),console.log(b.countryFilter);for(var d=c.find(".filter-chosen"),e="",f=0;f<b.countryFilter.length;f++)e+="<li>"+b.countries[b.countryFilter[f]].name+"</li> ";d.html(e)},b.filterByCountries=function(a){return b.countryFilter.length>0?-1!==b.countryFilter.indexOf(a.country_id):!0},b.setFactoryFilter=function(a){var c=$(".filter-factories");-1==b.factoryFilter.indexOf(a)?(b.factoryFilter.push(a),c.find('[data-factory="'+a+'"]').addClass("active")):(b.factoryFilter.splice(b.factoryFilter.indexOf(a),1),c.find('[data-factory="'+a+'"]').removeClass("active")),console.log(b.factoryFilter);for(var d=c.find(".filter-chosen"),e="",f=0;f<b.factoryFilter.length;f++)e+="<li>"+b.factories[b.factoryFilter[f]].name+"</li> ";d.html(e)},b.filterByFactories=function(a){return b.factoryFilter.length>0?-1!==b.factoryFilter.indexOf(a.factory_id):!0},b.setColorFilter=function(a){var c=$(".filter-colors");-1==b.colorFilter.indexOf(a)?(b.colorFilter.push(a),c.find('[data-color="'+a+'"]').addClass("active")):(b.colorFilter.splice(b.colorFilter.indexOf(a),1),c.find('[data-color="'+a+'"]').removeClass("active"));for(var d=c.find(".filter-chosen"),e="",f=0;f<b.colorFilter.length;f++)e+='<li style="background-color: #'+b.colors[b.colorFilter[f]].css_code+'"></li> ';if(d.html(e),b.colorFilterArr=[],b.colorFilter.length>0)for(var g=0;g<b.colorFilter.length;g++)for(var h=0;h<b.collectionColors[b.colorFilter[g]].length;h++)-1==b.colorFilterArr.indexOf(b.collectionColors[b.colorFilter[g]][h])&&b.colorFilterArr.push(b.collectionColors[b.colorFilter[g]][h])},b.filterByColors=function(a){return b.colorFilterArr.length>0?-1!==b.colorFilterArr.indexOf(+a.id):!0},b.setPriceFilter=function(a){var c=$(".filter-prices");c.find('[data-price="'+a+'"]').hasClass("active")?(c.find("[data-price]").removeClass("active"),b.minPrice=""):(c.find("[data-price]").removeClass("active"),c.find('[data-price="'+a+'"]').toggleClass("active"),b.minPrice=+a);var d=c.find(".filter-chosen"),e="";e=""!=b.minPrice?c.find('[data-price="'+a+'"]').text():"",d.html("<li>"+e+"</li>")},b.filterByPrice=function(a){return 1e3==b.minPrice?b.collectionPrices[a.id]<=1e3:2e3==b.minPrice?b.collectionPrices[a.id]<=2e3:2001==b.minPrice?b.collectionPrices[a.id]>=2001:!0},b.setSurfaceFilter=function(a){var c=$(".filter-surface");-1==b.surfaceFilter.indexOf(a)?(b.surfaceFilter.push(a),c.find('[data-surface="'+a+'"]').addClass("active")):(b.surfaceFilter.splice(b.surfaceFilter.indexOf(a),1),c.find('[data-surface="'+a+'"]').removeClass("active")),console.log(b.surfaceFilter);for(var d=c.find(".filter-chosen"),e="",f=0;f<b.surfaceFilter.length;f++)e+="<li>"+b.surfaceTypes[b.surfaceFilter[f]].name+"</li> ";if(d.html(e),b.surfaceFilterArr=[],b.surfaceFilter.length>0)for(var g=0;g<b.surfaceFilter.length;g++)for(var h=0;h<b.collectionSurfaces[b.surfaceFilter[g]].length;h++)-1==b.surfaceFilterArr.indexOf(b.collectionSurfaces[b.surfaceFilter[g]][h])&&b.surfaceFilterArr.push(b.collectionSurfaces[b.surfaceFilter[g]][h])},b.filterBySurface=function(a){return b.surfaceFilterArr.length>0?-1!==b.surfaceFilterArr.indexOf(+a.id):!0},b.setPlacesFilter=function(a){var c=$(".filter-place");-1==b.placeFilter.indexOf(a)?(b.placeFilter.push(a),c.find('[data-place="'+a+'"]').addClass("active")):(b.placeFilter.splice(b.placeFilter.indexOf(a),1),c.find('[data-place="'+a+'"]').removeClass("active"));for(var d=c.find(".filter-chosen"),e="",f=0;f<b.placeFilter.length;f++)e+="<li>"+b.places[b.placeFilter[f]].name+"</li> ";if(d.html(e),b.placeFilterArr=[],b.placeFilter.length>0)for(var g=0;g<b.placeFilter.length;g++)for(var h=0;h<b.collectionPlaces[b.placeFilter[g]].length;h++)-1==b.placeFilterArr.indexOf(b.collectionPlaces[b.placeFilter[g]][h])&&b.placeFilterArr.push(b.collectionPlaces[b.placeFilter[g]][h])},b.filterByPlace=function(a){return b.placeFilterArr.length>0?-1!==b.placeFilterArr.indexOf(a.id):!0},b.showFilters=function(a){$(a).hasClass("active")?$(a).removeClass("active"):($(".filter").removeClass("active"),$(a).addClass("active"))}})}]),angular.module("plitkaApp").controller("ProjectsCtrl",["$http",function(a){var b=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){b.data=a,b.projects=b.data.projects,b.galleries=b.data.galleries,b.photos=b.data.photos,b.collections=b.data.collections,b.products=b.data.products,b.factory=b.data.factory,b.productTypes=b.data.product_type});$(".fancybox").fancybox({padding:0,helpers:{title:{type:"inside"}}})}]),angular.module("plitkaApp").directive("promoSlider",function(){return{templateUrl:"views/partials/slider.html",restrict:"E",controllee:"SliderCtrl"}}),angular.module("plitkaApp").controller("SliderCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("plitkaApp").controller("SeparticleCtrl",["$http","$routeParams",function(a,b){$("html, body").animate({scrollTop:$("main").offset().top},400);var c=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){c.data=a,c.articleId=b.id,c.articles=c.data.articles,c.photos=c.data.photos})}]),angular.module("plitkaApp").controller("SearchCtrl",["$http",function(){var a=this;a.searchStr="",a.sendForm=function(a){$.ajax({type:"POST",url:"http://plitka.dev.grapheme.ru/ajax/search",data:{searctString:a},dataType:"json"}).done(function(){}).fail(function(){}).always(function(){})}}]),angular.module("plitkaApp").controller("SearchResultsCtrl",function(){var a=this;a.catalogItems=[{},{},{},{}],a.catalogArticles=[{},{},{},{}]}),angular.module("plitkaApp").controller("CatalogItemCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("plitkaApp").controller("CollectionCtrl",["$http","$routeParams",function(a,b){var c=this;a.get("http://plitka.dev.grapheme.ru/application/get").success(function(a){if(c.data=a,c.collectionId=b.id,c.products=c.data.products,c.collections=c.data.collections,c.photos=c.data.photos,c.countries=c.data.countries,c.factories=c.data.factory,c.galleries=c.data.galleries,c.productTypes=c.data.product_type,c.surfaceTypes=c.data.surface_type,c.formats=c.data.format,c.collection=c.collections[c.collectionId],c.collectionPhoto=c.photos[c.galleries[c.collection.gallery_id].photos[0]].full,c.country=c.countries[c.collections[c.collectionId].country_id],c.factoryName=c.factories[c.collections[c.collectionId].factory_id].name,c.factoryImg=c.photos[c.factories[c.collections[c.collectionId].factory_id].image_id].full,c.collectionSurfType=c.productTypes[c.collection.product_type_id].name,c.dicvals=c.collection.related_dicvals,c.dicvalsArr=[],c.dicvals.length>0)for(var d=0;d<c.dicvals.length;d++)c.dicvalsArr.push(c.dicvals[d].name);c.productsArr=[];for(var e in c.products)c.products[e].collection_id==c.collectionId&&c.productsArr.push(c.products[e])})}]);